p8105_hw2_fw2394
================
Fang Wang
2024-09-29

# Problem 1

## Set up the working_directory:

``` r
setwd("/Users/fangwang/Downloads/P8105 Data Science I/p8105_hw2_fw2394")
```

## Load necessary libraries:

``` r
library (tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library (dplyr)
```

## Load the dataset:

``` r
nyc_transit =
  read_csv ("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") |> janitor::clean_names() |> 
  select (line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) |> 
mutate(
    entry = case_match(
      entry,
      "YES" ~ TRUE,
      "NO" ~ FALSE
    )
  )
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
str(nyc_transit)
```

    ## tibble [1,868 × 19] (S3: tbl_df/tbl/data.frame)
    ##  $ line             : chr [1:1868] "4 Avenue" "4 Avenue" "4 Avenue" "4 Avenue" ...
    ##  $ station_name     : chr [1:1868] "25th St" "25th St" "36th St" "36th St" ...
    ##  $ station_latitude : num [1:1868] 40.7 40.7 40.7 40.7 40.7 ...
    ##  $ station_longitude: num [1:1868] -74 -74 -74 -74 -74 ...
    ##  $ route1           : chr [1:1868] "R" "R" "N" "N" ...
    ##  $ route2           : chr [1:1868] NA NA "R" "R" ...
    ##  $ route3           : chr [1:1868] NA NA NA NA ...
    ##  $ route4           : chr [1:1868] NA NA NA NA ...
    ##  $ route5           : chr [1:1868] NA NA NA NA ...
    ##  $ route6           : chr [1:1868] NA NA NA NA ...
    ##  $ route7           : chr [1:1868] NA NA NA NA ...
    ##  $ route8           : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ route9           : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ route10          : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ route11          : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ entry            : logi [1:1868] TRUE TRUE TRUE TRUE TRUE TRUE ...
    ##  $ vending          : chr [1:1868] "YES" "YES" "YES" "YES" ...
    ##  $ entrance_type    : chr [1:1868] "Stair" "Stair" "Stair" "Stair" ...
    ##  $ ada              : logi [1:1868] FALSE FALSE FALSE FALSE FALSE FALSE ...

**The dataset contains 19 variables, including line, station_name,
station_latitude, station_longitude, route1 to route11, entry, vending,
entrance_type, and ada. It has a total of 1,868 observations, meaning
there are 1,868 rows and 19 columns.So far, I have performed the
following steps to clean and organize the data. First, I converted all
variable names to lowercase using janitor::clean_names(). Then, I
selected the 19 relevant columns using the select() function. Finally, I
transformed the entry variable from a character type (“YES” or “NO”) to
a logical type (TRUE or FALSE) using case_match(). As a result, the
dataset is now tidier and more structured compared to the original
version. **

## Find how many distinct stations:

``` r
combined_station_line = nyc_transit |> 
  mutate (station_name_line = paste (station_name, line, sep = " ")) 

unique_stations = 
  combined_station_line |> 
  select (station_name_line) |>
  distinct()
nrow(unique_stations)
```

    ## [1] 465

## Find how many stations that are ADA compliant:

``` r
ada_compliant =
  nyc_transit |> 
  filter (ada == "TRUE")
nrow(ada_compliant)
```

    ## [1] 468

## Calcuate the proportion of stations without vending allow entrance:

``` r
proportion_allow_entrance = nyc_transit |> 
  filter(vending == "NO") |>
  summarize(prop = mean(entry == "TRUE"))
print(proportion_allow_entrance)
```

    ## # A tibble: 1 × 1
    ##    prop
    ##   <dbl>
    ## 1 0.377

## Reformat data so that route number and route name are distinctive varaibles:

``` r
nyc_transit_long = combined_station_line |> 
  mutate(across(route1:route11, as.character)) |> 
  pivot_longer(
    cols = route1:route11,
    names_to = "route_number",
    values_to = "route_name"
  ) |> 
  select (route_number, route_name, station_name_line, everything())
head(nyc_transit_long)
```

    ## # A tibble: 6 × 11
    ##   route_number route_name station_name_line line   station_name station_latitude
    ##   <chr>        <chr>      <chr>             <chr>  <chr>                   <dbl>
    ## 1 route1       R          25th St 4 Avenue  4 Ave… 25th St                  40.7
    ## 2 route2       <NA>       25th St 4 Avenue  4 Ave… 25th St                  40.7
    ## 3 route3       <NA>       25th St 4 Avenue  4 Ave… 25th St                  40.7
    ## 4 route4       <NA>       25th St 4 Avenue  4 Ave… 25th St                  40.7
    ## 5 route5       <NA>       25th St 4 Avenue  4 Ave… 25th St                  40.7
    ## 6 route6       <NA>       25th St 4 Avenue  4 Ave… 25th St                  40.7
    ## # ℹ 5 more variables: station_longitude <dbl>, entry <lgl>, vending <chr>,
    ## #   entrance_type <chr>, ada <lgl>

## To find how many distinct stations serve the A train:

``` r
nyc_transit_long |> 
  filter (route_name == "A") |> 
  distinct(station_name_line) |> 
  count() 
```

    ## # A tibble: 1 × 1
    ##       n
    ##   <int>
    ## 1    60

## To find how many stations that serve the A train are ADA compliant:

``` r
nyc_transit_long |> 
  filter (route_name == "A", ada == "TRUE") |> 
  count() 
```

    ## # A tibble: 1 × 1
    ##       n
    ##   <int>
    ## 1   107
